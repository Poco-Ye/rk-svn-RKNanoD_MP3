/*
********************************************************************************************
*
*                Copyright (c): 2014 - 2014 + 5, WJR
*                             All rights reserved.
*
* FileName: Cpu\NanoC\lib\hifi_ape.c
* Owner: WJR
* Date: 2014.11.28
* Time: 16:59:12
* Desc: 
* History:
*    <author>    <date>       <time>     <version>     <Desc>
*    WJR     2014.11.28     16:59:12   1.0
********************************************************************************************
*/

#include "SysInclude.h"
#include "audio_main.h"

#pragma arm section code = "ApeHDecCode", rodata = "ApeHDecCode", rwdata = "ApeHDecData", zidata = "ApeHDecBss"
/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   #include define                                   
*
*---------------------------------------------------------------------------------------------------------------------
*/
#include "hifi.h"
#include "hifi_ape.h"
#include "Hw_hifi.h"



/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   #define / #typedef define     					 
*
*---------------------------------------------------------------------------------------------------------------------
*/

#define _CPU_NANOD_LIB_HIFI_APE_READ_  __attribute__((section("cpu_nanod_lib_hifi_ape_read")))
#define _CPU_NANOD_LIB_HIFI_APE_WRITE_ __attribute__((section("cpu_nanod_lib_hifi_ape_write")))
#define _CPU_NANOD_LIB_HIFI_APE_INIT_  __attribute__((section("cpu_nanod_lib_hifi_ape_init")))
#define _CPU_NANOD_LIB_HIFI_APE_SHELL_  __attribute__((section("cpu_nanod_lib_hifi_ape_shell")))


/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   local variable define     	     				 
*
*---------------------------------------------------------------------------------------------------------------------
*/

/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   global variable define     	     				 
*
*---------------------------------------------------------------------------------------------------------------------
*/



/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   local function declare     	     				 
*
*---------------------------------------------------------------------------------------------------------------------
*/



/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   API(read) define                    				 
*
*---------------------------------------------------------------------------------------------------------------------
*/

/*******************************************************************************
** Name: APE_Clear
** Input:UINT32 HifiId
** Return: rk_err_t
** 用于一首歌刚开始或者一首歌刚结束
** Owner:WJR
** Date: 2014.12.5
** Time: 17:49:09
*******************************************************************************/
//_CPU_NANOD_LIB_HIFI_APE_READ_
READ API rk_err_t APE_Clear(UINT32 HifiId)
{
    HIFIACC * pHifi = HifiPort(HifiId);
    pHifi->APE_CFG |= APE_CLC;
}
/*******************************************************************************
** Name: APE_Set_CFG
** Input:UINT32 HifiId,, int lpc_quant,int version,int_com_level
** Return: rk_err_t
** Owner:WJR
** Date: 2014.11.28
** Time: 17:01:15
*******************************************************************************/
//_CPU_NANOD_LIB_HIFI_APE_READ_
READ API rk_err_t APE_Set_CFG(UINT32 HifiId,int version,int com_level)
{
    HIFIACC * pHifi = HifiPort(HifiId);
    if(version <3980)
    {
       pHifi->APE_CFG =APE_VERSION_LESS_3980;
    }
    else
    {
       pHifi->APE_CFG =APE_VERSION_EQUAL_OR_GREAT_3980;
    }
    if(com_level == 1000)
    {
       pHifi->APE_CFG |=APE_COMPRESS_LEVEL_1;
    }
    else if(com_level == 2000)
    {
       pHifi->APE_CFG |=APE_COMPRESS_LEVEL_2|APE_LPC_QUANT_16;
    }
    else if(com_level == 3000)
    {
       pHifi->APE_CFG |=APE_COMPRESS_LEVEL_3|APE_LPC_QUANT_64;
    }
    else if(com_level == 4000)
    {
       pHifi->APE_CFG |=APE_COMPRESS_LEVEL_4|APE_LPC_QUANT_32|APE_LPC_QUANT_256;
    }
    else if(com_level == 5000)
    {
       pHifi->APE_CFG |=APE_COMPRESS_LEVEL_5|APE_LPC_QUANT_16|APE_LPC_QUANT_256\
                       | APE_LPC_QUANT_1280;
    }
    // printf("APE_CFG 0x%x \n",pHifi->APE_CFG);
}



/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   local function(read) define      				 
*
*---------------------------------------------------------------------------------------------------------------------
*/



/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   API(write) define                    			 
*
*---------------------------------------------------------------------------------------------------------------------
*/



/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   local function(write) define         			 
*
*---------------------------------------------------------------------------------------------------------------------
*/



/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   API(init) define             	     			 
*
*---------------------------------------------------------------------------------------------------------------------
*/



/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   local function(init) define              	  		 
*
*---------------------------------------------------------------------------------------------------------------------
*/



/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   API(shell) define              	  		 
*
*---------------------------------------------------------------------------------------------------------------------
*/

/*
*---------------------------------------------------------------------------------------------------------------------
*
*                                                   local function(shell) define              	  		 
*
*---------------------------------------------------------------------------------------------------------------------
*/


#pragma arm section code

